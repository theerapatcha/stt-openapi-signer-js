"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=(e=require("crypto"))&&"object"==typeof e&&"default"in e?e.default:e,i=require("asn1.js"),r=require("bn.js"),n=i.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).objid().optional(),this.key("publicKey").explicit(1).bitstr().optional())})),a=function(e){return n.encode({version:new r(1),privateKey:e.getPrivateKey(),parameters:(t="1.2.840.10045.3.1.7",t.split(".").map((function(e){return parseInt(e,10)})))},"pem",{label:"EC PRIVATE KEY"});var t};exports.sign=function(e,i,r,n){void 0===n&&(n=null);var s=n||(new Date).getTime(),o=function(e,t,i){return e+"."+t+"."+i}(e,r,s),p=t.createSign("SHA256");p.update(o),p.end();var u=t.createECDH("prime256v1");return u.setPrivateKey(i,"base64"),{signature:p.sign(a(u),"hex"),timestamp:s}};
